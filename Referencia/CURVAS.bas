#!basic-start=3050

#!system-vars:16423=255
#!system-vars:E_PPC=3000
#!system-vars:DEST=20018
#!system-vars:X_PTR=49152
#!system-vars:BERG=11
#!system-vars:MEM=16477
#!system-vars:S_TOP=2530
#!system-vars:OLDPPC=120
#!system-vars:FLAGX=1
#!system-vars:STRLEN=14
#!system-vars:FRAMES=62895
#!system-vars:COORDS=5423
#!system-vars:MEMBOT=[0,0,0,0,0,0,140,128,0,0,132,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]

10 REM "CURVAS FANTASTICAS"
20 REM MICRO SISTEMAS - JACBS
30 DIM A(80)
40 DIM B(80)
50 LET I=0
60 LET MIN=0
70 LET MAX=0
80 LET AUX=0
90 PRINT AT 8,10;"FORMULA ?"
100 INPUT A$
110 CLS 
120 IF A$(1)="R" THEN GOTO 500
130 IF A$(1)="X" THEN GOTO 1000
140 LET C=-10
150 LET D=10
160 GOSUB 1500
170 LET G=4*D
180 FOR X=C TO D STEP (D-C)/79
190 LET Y=VAL B$
200 IF ABS Y>G THEN GOTO 220
210 GOSUB 2000
220 NEXT X
230 GOSUB 2500
240 GOTO 3000
500 LET C=.004
510 LET D=2
520 GOSUB 1500
530 LET H=4*D
540 FOR T=C*PI TO D*PI STEP (D*PI-C*PI)/79
550 IF A$(2)<>"=" THEN GOTO 640
560 LET F=VAL B$
570 LET X=F*COS T
580 LET Y=F*SIN T
590 IF ABS X>H OR ABS Y>H THEN GOTO 610
600 GOSUB 2000
610 NEXT T
620 GOSUB 2500
630 GOTO 3000
640 IF SGN VAL B$=-1 THEN GOTO 610
650 LET E=SQR VAL B$
660 LET X=E*COS T
670 LET Y=E*SIN T
680 GOTO 590
1000 LET C$=A$(3 TO LEN A$)
1010 PRINT AT 8,6;"FORMULA DE Y?"
1020 INPUT A$
1030 CLS 
1040 LET C=0
1050 LET D=2
1060 GOSUB 1500
1070 FOR T=C*PI TO D*PI STEP (D*PI-C*PI)/79
1080 LET X=VAL C$
1090 LET Y=VAL B$
1100 GOSUB 2000
1110 NEXT T
1120 GOSUB 2500
1130 GOTO 3000
1500 FAST 
1510 LET A$=A$+" "
1520 FOR N=1 TO LEN A$
1530 IF A$(N)=":" THEN GOTO 1580
1540 NEXT N
1550 LET B$=A$(3 TO N-1)
1560 IF A$(2)<>"=" THEN LET B$=A$(5 TO N-1)
1570 RETURN 
1580 FOR P=N+1 TO LEN A$
1590 IF A$(P)="," THEN GOTO 1650
1600 NEXT P
1610 FOR S=P+1 TO LEN A$
1620 IF A$(S)=":" THEN LET D=VAL A$(P+1 TO S-1)
1630 NEXT S
1640 GOTO 1550
1650 LET C=VAL A$(N+1 TO P-1)
1660 GOTO 1610
2000 LET I=I+1
2010 LET A(I)=X
2020 LET B(I)=Y
2030 IF MIN>X THEN LET MIN=X
2040 IF MIN>Y THEN LET MIN=Y
2050 IF MAX<=X THEN LET MAX=X
2060 IF MAX<=Y THEN LET MAX=Y
2070 RETURN 
2500 LET D$="+"
2510 PRINT AT 11,15;D$
2520 PRINT AT 0,15;D$
2530 PRINT AT 11,3;D$
2540 PRINT AT 21,15;D$
2550 PRINT AT 11,27;D$
2560 IF AUX<=ABS MIN THEN LET AUX=ABS MIN
2570 IF AUX<=ABS MAX THEN LET AUX=ABS MAX
2580 LET K=21/AUX
2590 SLOW 
2600 FOR N=1 TO I
2610 PLOT A(N)*K+31,B(N)*K+21
2620 NEXT N
2630 RETURN 
3000 PAUSE 4E4
3005 PRINT AT 21,0;"OUTRA CURVA?"
3010 INPUT Z$
3020 CLS 
3030 GOTO 50
3040 SAVE "CURVA%S"
3050 RUN 
